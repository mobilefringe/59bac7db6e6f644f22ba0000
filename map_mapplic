<link href="//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/text/css/1510935230000/mapplic.css" rel="stylesheet">
<link href="//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/text/css/1485967426000/map.css" rel="stylesheet">
<script type="text/javascript" src="//mallmaverick.cdn.speedyrails.net/javascripts/mapsvg/jquery.mousewheel.js"></script>
<script src="//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/text/javascript/1487363250000/mapplic.js"></script>
<script src="//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/text/javascript/1484859750000/hammer.min.js"></script>

<style>
    .mapplic-pin{
        /*background-color: transparent!important;    */
    }
    /* INTERACTIVE ELEMENTS */
    /* clickable elements */
    .mapplic-clickable:not(g),
    g.mapplic-clickable > * {
    	opacity: 1;
    	/*fill: #b7a6bd*/;
    }
    
    /* hovered elements */
    .mapplic-clickable:not(g):hover,
    g.mapplic-clickable:hover > * {
    	opacity: 1;
    	fill: #be7bf4;
    }
    
    /* active elements */
    .mapplic-active,
    a.mapplic-active > path,
    g.mapplic-active > * {
    	fill: #a366d4;
    	opacity: 1.0 !important;
    }

</style>
<div style="position:relative; height:900px;">
    <div id="mapplic" class="mapplic">
    
    </div>
    <img id="original_svg" src="//mallmaverick.com/system/properties/svgmaps/000/000/056/original/Northpark_-_Map_-_Nov-03-2017.svg?1509986633" class="" alt="" style="visibility:hidden; position:absolute; z-index:-1;top:0;left:0;">
</div>


<script>
    $(document).ready(function(e){
        init(e);
        var floor1_stores = null;
        var self = null;
        function renderPage(){
            var stores = getStoresList();
            floor1_stores= $.grep(stores, function( n, i ) {
                return ( n.z_coordinate == 1);
            });
            var floor2_stores= $.grep(stores, function( n, i ) {
                return ( n.z_coordinate == 2);
            });
            
            // console.log(floor1_stores,floor2_stores);
            var mall_json = {};
            var landmarks = {};
            mall_json.mapwidth = "1000";
            mall_json.mapheight = "1000";
            mall_json.categories=[]; 
            var store_cats = getStoreCategories();
            // console.log(store_cats);
            $.each(store_cats, function(key,val){
                var temp_val = {};
                temp_val.id = val.id;
                temp_val.title= val.name;
                temp_val.color= "#b7a6bd";
                temp_val.show="true";
                mall_json.categories.push(temp_val);
            });
            mall_json.levels=[]; 
            // need to add the following for each floor we want to configure.
            var floor_1 ={};
            floor_1.id = "first-floor";
            floor_1.title = "Floor 1";
            floor_1.map = "//www.mallmaverick.com/system/site_images/photos/000/034/516/original/Northpark_-_Map_-_Floor_1_-modifed_for_Mapplic.svg";
            floor_1.minimap = "//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/image/jpeg/1510940237000/Northpark_-_Map_-_Floor_1_-_Mapplic_Test_1.jpg";
            floor_1.show="true";
            floor_1.locations = [];
            var svg_width = null;
            var svg_height = null;
            $("img").load(function() {
                svg_width = $(this).width();
                svg_height = $(this).height();
                // console.log($("#original_svg"));
                console.log("width",svg_width,"height",svg_height)
            });
            
            
           
        }
        
        loadMallDataCached(renderPage);
        show_content();
        $(window).resize();
        
        // setTimeout(function(){
        //     console.log(floor1_stores.length);
        //      $.each(floor1_stores, function(key,val){
                
        //         if(val.svgmap_region != null){
        //             console.log(val.svgmap_region);
        //             var bbox = $("#"+val.svgmap_region)[0].getBBox();
        //             console.log(bbox);
                    
        //             var locations = self.data.levels[0].locations;
        //             // console.log(locations);
        //             var this_location = $.grep(locations, function( n, i ) {
        //                 if(n.id == null){n.id=""}
        //                 return ( n.id.toString() == val.svgmap_region.toString());
        //             });
        //             console.log(this_location);
        //         }
                
        //     });
            
        // },2000);
    });
        
    
</script>
<!--//www.mallmaverick.com/system/site_images/photos/000/034/436/original/Northpark_-_Map_-_Floor_1_-_Mapplic_Test_1.svg?1510930761-->
<!--//www.mallmaverick.com/system/site_images/photos/000/034/472/original/Northpark_-_Map_-_Floor_2_-_Mapplic_Test_1.svg?1510955610-->
<!--//www.mallmaverick.com/system/site_images/photos/000/034/516/original/Northpark_-_Map_-_Floor_1_-modifed_for_Mapplic.svg-->
<!--//codecloud.cdn.speedyrails.net/sites/59bac7db6e6f644f22ba0000/application/json/1472253662000/mall.json-->