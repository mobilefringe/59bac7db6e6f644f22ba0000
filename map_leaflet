<!--<style>-->
<!--   .map_container {-->
<!--       height: 90%;-->
<!--        width: 90%;-->
<!--        margin:auto;-->
<!--   }-->
<!--    #map {-->
        <!--/*position: absolute;*/-->
<!--        height: 100%;-->
<!--        width: 100%;-->
<!--        margin:auto;-->
<!--        background-color: #fffff0;-->
<!--        overflow:hidden;-->
<!--    }-->
<!--</style>-->
     <!--Base libraries-->
<!--    <script src="http://www.sumbera.com/gist/js/leaflet/svg/scaled/d3-3.5.5.min.js"></script>-->
<!--    <script src="http://www.sumbera.com/gist/js/leaflet/svg/scaled/leaflet.js"></script>-->
<!--    <script src="http://assets.codecloudapp.com/sites/59bac7db6e6f644f22ba0000/text/javascript/1505852644000/L.SvgScaleOverlay.js"></script>-->
<!--    <script src="http://www.sumbera.com/gist/data.js" charset="utf-8"></script>-->
<!--    <div class="map_container">-->
<!--        <div id="map">-->
          
<!--        </div>-->
<!--    </div>-->
    
    <!--<div id="tooltip" style="width:500px; height:250px;">-->
    <!-- </div>-->


<!--<script>-->
<!--    $(document).ready(function(e){-->
<!--        init(e);-->
<!--        function renderAll(){-->
<!--        var map = L.map('map', {-->
<!--            crs: L.CRS.Simple,-->
            <!--// zoom:1,-->
<!--            minZoom : 1,-->
<!--            maxZooom: 5-->
<!--        });-->
        <!--var bounds =[[-226.953125,154],[938.046875,-199]]//[[89,219], [843,730]];// [[0,0], [500,500]];-->
<!--        var image = L.imageOverlay('//mallmaverick.cdn.speedyrails.net/system/properties/svgmaps/000/000/028/original/Londonderry_DB_4.svg?1497642416', bounds).addTo(map);-->
<!--        map.fitBounds(bounds);-->
<!--        var yx = L.latLng;-->
<!--        var xy = function(x, y) {-->
            <!--if (L.Util.isArray(x)) {    // When doing xy([x, y]);-->
<!--                return yx(x[1], x[0]);-->
<!--            }-->
            <!--return yx(y, x);  // When doing xy(x, y);-->
<!--        };-->
<!--        var smallIcon = new L.Icon({-->
<!--            iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-icon.png',-->
<!--            iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-icon-2x.png',-->
<!--            iconSize:    [25, 41],-->
<!--            iconAnchor:  [12, 41],-->
<!--            popupAnchor: [1, -34],-->
<!--            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',-->
<!--            shadowSize:  [0,0]-->
<!--        });-->
<!--         var smallerIcon = new L.Icon({-->
<!--            iconUrl: 'http://assets.codecloudapp.com/sites/59bac7db6e6f644f22ba0000/image/png/1496327260000/823841_message_512x512.png',-->
<!--            iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-icon-2x.png',-->
<!--            iconSize:    [25, 41],-->
<!--            iconAnchor:  [12, 41],-->
<!--            popupAnchor: [1, -34],-->
<!--            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',-->
<!--            shadowSize:  [0,0]-->
<!--        });-->
<!--        var stores = getStoresList();-->
<!--        console.log(stores);-->
        
<!--        var sol      =xy( 13.4,  56.5);-->
<!--        var mizar    = xy( 41.6, 130.1);-->
<!--        var store    = xy( stores[0].x_coordinate,stores[0].y_coordinate);-->
        <!--// var kruegerZ = xy( 13.4,  56.5);-->
        <!--// var deneb    = xy(218.7,   8.3);-->
        
<!--        L.marker(sol, {icon:smallIcon}).addTo(map).bindPopup('Sol');-->
<!--        L.marker(mizar,{icon:smallIcon}).addTo(map).bindPopup('Mizar');-->
<!--        L.marker(store,{icon:smallerIcon}).addTo(map).bindPopup('Store');-->
        
<!--       map.on('click', function(e) {       -->
<!--           console.log("hey", e);-->
<!--            var popLocation= e.latlng;-->
<!--            var popup = L.popup()-->
<!--            .setLatLng(popLocation)-->
<!--            .setContent('<p>Hello world!<br />This is a nice popup.</p>')-->
<!--            .openOn(map);        -->
<!--        });-->
        
<!--        $('.custom_backdrop').remove();-->
<!--        $('.yield').fadeIn();-->
<!--    }-->
<!--        loadMallDataCached(renderAll);-->
<!--    });-->
<!--</script>-->
<style>
    html, body, #mapsWrapper { width:100%; height:400px; margin:0; padding:0; }
    svg {
        width:500px;
        height:700px;
    }
</style>
<div id="mapsWrapper"></div>
<script src="https://d3js.org/d3.v4.min.js"></script>
 <script src="http://www.sumbera.com/gist/js/leaflet/svg/scaled/leaflet.js"></script>
 <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" rel="stylesheet">
<script>
    $(document).ready(function () {

        // initialize the map
        var map;
        
        fnLoadMaps();
        
        function fnLoadMaps(){
        
            map = new L.Map("mapsWrapper", {
                crs: L.CRS.Simple,
                zoom:-10,
                min_zoom:0,
                max_zoom:15,
                center:[50,50]
            });
            // Add an SVG element to Leafletâ€™s overlay pane
            var svg = d3.select(map.getPanes().overlayPane).append("svg");
                // g = svg.append("g").attr("class", "leaflet-zoom-hide");
            // console.log (svg.bounds());
            
       
            d3.xml("//mallmaverick.cdn.speedyrails.net/system/properties/svgmaps/000/000/028/original/Londonderry_DB_4.svg?1497642416").mimeType("image/svg+xml").get(function(error, svgImg) {
              if (error) throw error;
              console.log(svgImg.documentElement);
              map.getPanes().overlayPane.appendChild(svgImg.documentElement);
            });
            // var store    = xy( stores[0].x_coordinate,stores[0].y_coordinate);
        }
        map.on("viewreset", reset);

		reset();
		// fit the SVG element to leaflet's map layer
		function reset() {
        
			bounds = path.bounds(geoShape);

			var topLeft = bounds[0],
				bottomRight = bounds[1];

			svg .attr("width", bottomRight[0] - topLeft[0])
				.attr("height", bottomRight[1] - topLeft[1])
				.style("left", topLeft[0] + "px")
				.style("top", topLeft[1] + "px");

			g .attr("transform", "translate(" + -topLeft[0] + "," 
			                                  + -topLeft[1] + ")");

			// initialize the path data	
			d3_features.attr("d", path)
				.style("fill-opacity", 0.7)
				.attr('fill','blue');
		} 

		// Use Leaflet to implement a D3 geometric transformation.
		function projectPoint(x, y) {
			var point = map.latLngToLayerPoint(new L.LatLng(y, x));
			this.stream.point(point.x, point.y);
		}
        $('.custom_backdrop').remove();
        $('.yield').fadeIn();
    });
    </script>